<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Profile - Greenside AI</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='8' fill='%231a4d2e'/%3E%3Ctext x='50%25' y='54%25' dominant-baseline='middle' text-anchor='middle' font-family='system-ui' font-size='18' font-weight='700' fill='white'%3EG%3C/text%3E%3C/svg%3E">
    <link rel="manifest" href="/static/manifest.json">
    <link rel="stylesheet" href="/static/css/shared.css">
    <link rel="stylesheet" href="/static/css/profile.css">
    <style>
        .nav-dropdown{position:relative;display:inline-block}
        .nav-dropdown-btn{background:none;border:none;color:rgba(255,255,255,0.85);font-size:14px;cursor:pointer;padding:4px 8px;font-family:inherit}
        .nav-dropdown-btn:hover{color:#fff}
        .nav-dropdown-menu{display:none;position:absolute;top:100%;left:0;background:#fff;border-radius:8px;box-shadow:0 8px 30px rgba(0,0,0,0.15);min-width:180px;z-index:1000;padding:6px 0;margin-top:4px}
        .nav-dropdown-menu a{display:block;padding:8px 16px;color:#333;text-decoration:none;font-size:13px;white-space:nowrap}
        .nav-dropdown-menu a:hover{background:#f0fdf4;color:#1a4d2e}
        .nav-dropdown:hover .nav-dropdown-menu{display:block}
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="/" style="text-decoration:none;"><div class="logo">Greenside AI</div></a>
            <div class="nav-links">
                <a href="/">Chat</a>
                <a href="/dashboard">Dashboard</a>
                <a href="/spray-tracker">Spray Tracker</a>
                <div class="nav-dropdown">
                    <button class="nav-dropdown-btn">Tools ▾</button>
                    <div class="nav-dropdown-menu">
                        <a href="/calendar">Calendar</a>
                        <a href="/scouting">Scouting</a>
                        <a href="/equipment">Equipment</a>
                        <a href="/budget">Budget</a>
                        <a href="/irrigation">Irrigation</a>
                        <a href="/crew">Crew</a>
                        <a href="/soil">Soil</a>
                        <a href="/course-map">Course Map</a>
                        <a href="/cultivars">Cultivars</a>
                        <a href="/reports">Reports</a>
                        <a href="/calculator">Calculator</a>
                        <a href="/community">Community</a>
                    </div>
                </div>
                <a href="/resources">Resources</a>
                <a href="/logout">Log out</a>
            </div>
        </div>
    </header>

    <div class="profile-container">
        <div class="welcome-banner" id="welcome-banner">
            <h2>Welcome to Greenside AI!</h2>
            <p>Set up your course profile so the AI can tailor recommendations to your grass types, region, and setup.</p>
        </div>

        <!-- Profile switcher -->
        <div class="profile-switcher" id="profile-switcher" style="display:none;">
            <div class="profile-switcher-row">
                <select id="profile-select" onchange="switchProfile(this.value)"></select>
                <button class="profile-add-btn" onclick="showAddCourseModal()">+ Add Course</button>
            </div>
        </div>

        <h1 class="page-title">Course Profile</h1>
        <div class="autosave-indicator" id="autosave-indicator" style="display:none;">
            <span id="autosave-text">Saved</span>
        </div>
        <div class="completeness-bar">
            <div class="completeness-header">
                <span>Profile Completeness</span>
            </div>
            <div class="completeness-track"><div id="completeness-bar" class="completeness-fill"></div></div>
            <div id="completeness-label" class="completeness-label">Checking...</div>
        </div>
        <p class="page-subtitle">Your profile personalizes AI recommendations — no need to repeat your grass type or location every question.</p>

        <!-- Tab bar -->
        <div class="tab-bar">
            <button class="tab-btn active" data-tab="basics">Basics</button>
            <button class="tab-btn" data-tab="grasses">Grasses & Mowing</button>
            <button class="tab-btn" data-tab="sprayers">Sprayers</button>
            <button class="tab-btn" data-tab="programs">Programs</button>
            <button class="tab-btn" data-tab="cultural">Cultural Practices</button>
            <button class="tab-btn" data-tab="calendar">Calendar</button>
            <button class="tab-btn" data-tab="soil-water">Soil & Water</button>
        </div>

        <!-- ===== TAB 1: BASICS ===== -->
        <div class="tab-panel active" id="tab-basics">
            <div class="section">
                <h3>Basic Info</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="course_name">Course / Facility Name</label>
                        <input type="text" id="course_name" placeholder="e.g. Pine Valley Golf Club">
                    </div>
                    <div class="form-group">
                        <label for="turf_type">Facility Type</label>
                        <select id="turf_type" onchange="onFacilityTypeChange()">
                            <option value="">Select type...</option>
                            <option value="golf_course">Golf Course</option>
                            <option value="sports_field">Sports Field</option>
                            <option value="lawn_care">Lawn Care</option>
                            <option value="municipal">Municipal / Parks</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="city">City</label>
                        <input type="text" id="city" placeholder="e.g. Pine Valley">
                    </div>
                    <div class="form-group">
                        <label for="state">State</label>
                        <select id="state"><option value="">Select state...</option></select>
                        <span class="help-text">Auto-sets your region and climate zone</span>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="role">Your Role</label>
                        <select id="role">
                            <option value="">Select role...</option>
                            <option value="superintendent">Superintendent</option>
                            <option value="assistant_superintendent">Assistant Superintendent</option>
                            <option value="spray_tech">Spray Technician</option>
                            <option value="grounds_manager">Grounds Manager</option>
                            <option value="lawn_care_operator">Lawn Care Operator</option>
                            <option value="student">Student</option>
                            <option value="other">Other</option>
                        </select>
                        <span class="help-text">AI adjusts tone and detail level to your role</span>
                    </div>
                    <div class="form-group">
                        <label for="climate_zone">USDA Hardiness Zone <span style="font-weight:400;color:#9ca3af;">(auto from state)</span></label>
                        <input type="text" id="climate_zone" placeholder="e.g. 7a" maxlength="10">
                        <span class="help-text">Override if your microclimate differs</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== TAB 2: GRASSES & MOWING ===== -->
        <div class="tab-panel" id="tab-grasses">
            <div class="section">
                <h3>Grass Types</h3>
                <!-- Non-golf primary grass -->
                <div id="primary-grass-group">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="primary_grass">Primary Grass Type</label>
                            <select id="primary_grass"><option value="">Select grass type...</option></select>
                            <input type="text" id="primary_grass_cultivar" class="cultivar-input" placeholder="Cultivar (e.g. Tifway 419, A-4)">
                        </div>
                        <div class="form-group">
                            <label for="mow_primary">Mowing Height (inches)</label>
                            <input type="number" id="mow_primary" step="0.05" min="0.05" max="5" placeholder="e.g. 2.5">
                            <span class="help-text">Affects disease and product recommendations</span>
                        </div>
                    </div>
                </div>

                <!-- Golf course per-area grasses -->
                <div id="golf-grass-section" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="greens_grass">Greens</label>
                            <select id="greens_grass"><option value="">Select grass...</option></select>
                            <input type="text" id="greens_grass_cultivar" class="cultivar-input" placeholder="Cultivar (e.g. Pure Distinction, L-93)">
                        </div>
                        <div class="form-group">
                            <label for="tees_grass">Tees</label>
                            <select id="tees_grass"><option value="">Select grass...</option></select>
                            <input type="text" id="tees_grass_cultivar" class="cultivar-input" placeholder="Cultivar (optional)">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fairways_grass">Fairways — Primary</label>
                            <select id="fairways_grass"><option value="">Select grass...</option></select>
                            <input type="text" id="fairways_grass_cultivar" class="cultivar-input" placeholder="Cultivar (e.g. Tifway 419)">
                        </div>
                        <div class="form-group">
                            <label for="fairways_secondary_grass">Fairways — Overseeded / Secondary <span style="font-weight:400;color:#9ca3af;">(optional)</span></label>
                            <select id="fairways_secondary_grass"><option value="">None</option></select>
                            <span class="help-text">If fairways are overseeded or a mix of grasses</span>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="rough_grass">Rough — Primary</label>
                            <select id="rough_grass"><option value="">Select grass...</option></select>
                            <input type="text" id="rough_grass_cultivar" class="cultivar-input" placeholder="Cultivar (optional)">
                        </div>
                        <div class="form-group">
                            <label for="rough_secondary_grass">Rough — Overseeded / Secondary <span style="font-weight:400;color:#9ca3af;">(optional)</span></label>
                            <select id="rough_secondary_grass"><option value="">None</option></select>
                            <span class="help-text">If roughs are a mix or overseeded seasonally</span>
                        </div>
                    </div>

                    <h4>Acreage</h4>
                    <div class="form-row quad">
                        <div class="form-group"><label for="greens_acreage">Greens (ac)</label><input type="number" id="greens_acreage" step="0.1" min="0" placeholder="3.5"></div>
                        <div class="form-group"><label for="fairways_acreage">Fairways (ac)</label><input type="number" id="fairways_acreage" step="0.1" min="0" placeholder="28"></div>
                        <div class="form-group"><label for="tees_acreage">Tees (ac)</label><input type="number" id="tees_acreage" step="0.1" min="0" placeholder="4"></div>
                        <div class="form-group"><label for="rough_acreage">Rough (ac)</label><input type="number" id="rough_acreage" step="0.1" min="0" placeholder="45"></div>
                    </div>

                    <h4>Mowing Heights (inches)</h4>
                    <span class="help-text" style="display:block;margin-bottom:8px;">AI uses these for PGR rates, disease pressure, and cultural practice recommendations</span>
                    <div class="form-row quad">
                        <div class="form-group"><label for="mow_greens">Greens</label><input type="number" id="mow_greens" step="0.005" min="0.05" max="0.3" placeholder="0.125"></div>
                        <div class="form-group"><label for="mow_fairways">Fairways</label><input type="number" id="mow_fairways" step="0.05" min="0.2" max="2" placeholder="0.625"></div>
                        <div class="form-group"><label for="mow_tees">Tees</label><input type="number" id="mow_tees" step="0.05" min="0.15" max="1" placeholder="0.375"></div>
                        <div class="form-group"><label for="mow_rough">Rough</label><input type="number" id="mow_rough" step="0.25" min="0.5" max="5" placeholder="2.0"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== TAB 3: SPRAYERS ===== -->
        <div class="tab-panel" id="tab-sprayers">
            <div class="section">
                <h3>Sprayers</h3>
                <p style="font-size:13px;color:#6b7280;margin-bottom:16px;">Add your sprayers with GPA and tank size. Assign each to specific areas — they auto-fill in the Spray Tracker.</p>
                <div id="sprayers-list" style="margin-bottom:16px;"></div>
                <div id="sprayer-form" class="sprayer-form-panel">
                    <input type="hidden" id="sprayer-edit-id">
                    <div class="form-row">
                        <div class="form-group"><label for="sprayer-name">Sprayer Name</label><input type="text" id="sprayer-name" placeholder="e.g. Greens Sprayer"></div>
                        <div class="form-group"><label for="sprayer-nozzle">Nozzle Type <span style="color:#9ca3af;font-weight:400;">(optional)</span></label><input type="text" id="sprayer-nozzle" placeholder="e.g. AI3070, TeeJet 8002VS"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label for="sprayer-gpa">Spray Volume (GPA)</label><input type="number" id="sprayer-gpa" step="0.1" min="0" placeholder="e.g. 44"></div>
                        <div class="form-group"><label for="sprayer-tank">Tank Size (gallons)</label><input type="number" id="sprayer-tank" step="1" min="0" placeholder="e.g. 200"></div>
                    </div>
                    <div style="margin-bottom:12px;">
                        <label style="display:block;font-size:13px;font-weight:600;color:#374151;margin-bottom:6px;">Assigned Areas</label>
                        <div id="sprayer-areas" style="display:flex;flex-wrap:wrap;gap:8px;">
                            <label style="display:flex;align-items:center;gap:4px;font-size:13px;cursor:pointer;"><input type="checkbox" value="greens" class="sprayer-area-cb"> Greens</label>
                            <label style="display:flex;align-items:center;gap:4px;font-size:13px;cursor:pointer;"><input type="checkbox" value="tees" class="sprayer-area-cb"> Tees</label>
                            <label style="display:flex;align-items:center;gap:4px;font-size:13px;cursor:pointer;"><input type="checkbox" value="fairways" class="sprayer-area-cb"> Fairways</label>
                            <label style="display:flex;align-items:center;gap:4px;font-size:13px;cursor:pointer;"><input type="checkbox" value="rough" class="sprayer-area-cb"> Rough</label>
                        </div>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;">
                        <label style="display:flex;align-items:center;gap:4px;font-size:13px;cursor:pointer;"><input type="checkbox" id="sprayer-default"> Default sprayer (fallback for unassigned areas)</label>
                    </div>
                    <div style="display:flex;gap:8px;">
                        <button onclick="saveSprayer()" style="padding:8px 20px;background:#1a4d2e;color:white;border:none;border-radius:6px;font-size:13px;font-weight:600;cursor:pointer;">Save Sprayer</button>
                        <button onclick="cancelSprayerForm()" style="padding:8px 16px;background:#f3f4f6;color:#374151;border:none;border-radius:6px;font-size:13px;cursor:pointer;">Cancel</button>
                    </div>
                </div>
                <button onclick="showSprayerForm()" id="add-sprayer-btn" style="padding:10px 20px;background:#f0fdf4;color:#1a4d2e;border:1px dashed #86efac;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;width:100%;transition:background 0.2s;">+ Add Sprayer</button>
            </div>
        </div>

        <!-- ===== TAB 4: PROGRAMS ===== -->
        <div class="tab-panel" id="tab-programs">
            <div class="section">
                <h3>Programs & Budget</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label for="green_speed_target">Green Speed Target (Stimpmeter)</label>
                        <input type="number" id="green_speed_target" step="0.5" min="6" max="15" placeholder="e.g. 10.5">
                        <span class="help-text">Affects PGR and cultural practice recommendations</span>
                    </div>
                    <div class="form-group">
                        <label for="budget_tier">Budget Approach</label>
                        <select id="budget_tier">
                            <option value="">Select...</option>
                            <option value="budget">Budget-Conscious (generics first)</option>
                            <option value="moderate">Moderate (cost + performance balance)</option>
                            <option value="premium">Premium (best products, any cost)</option>
                        </select>
                        <span class="help-text">AI prioritizes cost-appropriate products</span>
                    </div>
                </div>

                <h4>Annual Nitrogen Budget (lbs N / 1000 sq ft)</h4>
                <span class="help-text" style="display:block;margin-bottom:8px;">AI factors this into fertility recommendations and spray tracker N tracking</span>
                <div class="form-row quad" id="n-budget-golf" style="display:none;">
                    <div class="form-group"><label for="n_greens">Greens</label><input type="number" id="n_greens" step="0.5" min="0" max="12" placeholder="4.0"></div>
                    <div class="form-group"><label for="n_fairways">Fairways</label><input type="number" id="n_fairways" step="0.5" min="0" max="12" placeholder="3.0"></div>
                    <div class="form-group"><label for="n_tees">Tees</label><input type="number" id="n_tees" step="0.5" min="0" max="12" placeholder="3.5"></div>
                    <div class="form-group"><label for="n_rough">Rough</label><input type="number" id="n_rough" step="0.5" min="0" max="12" placeholder="2.0"></div>
                </div>
                <div class="form-row" id="n-budget-simple">
                    <div class="form-group"><label for="n_primary">Annual N Budget</label><input type="number" id="n_primary" step="0.5" min="0" max="12" placeholder="e.g. 3.0"></div>
                </div>

                <h4>Overseeding Program</h4>
                <span class="help-text" style="display:block;margin-bottom:8px;">Helps AI time herbicide apps around your overseeding window</span>
                <div class="form-row">
                    <div class="form-group">
                        <label for="overseed_grass">Overseed Grass</label>
                        <select id="overseed_grass">
                            <option value="">None / N/A</option>
                            <option value="perennial ryegrass">Perennial Ryegrass</option>
                            <option value="annual ryegrass">Annual Ryegrass</option>
                            <option value="tall fescue">Tall Fescue</option>
                            <option value="kentucky bluegrass">Kentucky Bluegrass</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="overseed_date">Target Date</label>
                        <input type="text" id="overseed_date" placeholder="e.g. Oct 1">
                    </div>
                </div>
                <div class="form-row single">
                    <div class="form-group">
                        <label for="overseed_rate">Rate (lbs seed / 1000 sq ft)</label>
                        <input type="number" id="overseed_rate" step="1" min="0" max="50" placeholder="e.g. 8">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Common Problems</h3>
                <span class="help-text" style="display:block;margin-bottom:12px;">Check problems you deal with regularly. AI will suggest prevention proactively.</span>

                <div class="cb-group-label">Diseases</div>
                <div class="cb-group">
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="dollar_spot"> Dollar Spot</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="brown_patch"> Brown Patch</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="pythium"> Pythium</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="anthracnose"> Anthracnose</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="fairy_ring"> Fairy Ring</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="summer_patch"> Summer Patch</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="gray_leaf_spot"> Gray Leaf Spot</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="snow_mold"> Snow Mold</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="spring_dead_spot"> Spring Dead Spot</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="take_all_patch"> Take-All Patch</label>
                </div>

                <div class="cb-group-label">Weeds</div>
                <div class="cb-group">
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="poa_annua_weed"> Poa annua</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="crabgrass"> Crabgrass</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="goosegrass"> Goosegrass</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="sedge"> Sedge</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="clover"> Clover</label>
                </div>

                <div class="cb-group-label">Insects & Other</div>
                <div class="cb-group">
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="white_grubs"> White Grubs</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="armyworms"> Armyworms</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="nematodes"> Nematodes</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="algae"> Algae</label>
                    <label class="cb-label"><input type="checkbox" class="problem-cb" value="moss"> Moss</label>
                </div>
            </div>

            <div class="section">
                <h3>Preferred Products</h3>
                <div class="form-row single">
                    <div class="form-group">
                        <label for="preferred_products">Products or Brands You Prefer</label>
                        <textarea id="preferred_products" rows="2" placeholder="e.g. Heritage, Primo Maxx, Syngenta products, chlorothalonil"></textarea>
                        <span class="help-text">Comma-separated. AI will favor these when making recommendations.</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== TAB 5: CULTURAL PRACTICES ===== -->
        <div class="tab-panel" id="tab-cultural">
            <div class="section">
                <h3>Irrigation Schedule</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="irr_system_type">System Type</label>
                        <select id="irr_system_type">
                            <option value="">Select...</option>
                            <option value="overhead">Overhead / Rotary</option>
                            <option value="spray_heads">Spray Heads</option>
                            <option value="drip">Drip</option>
                            <option value="hand_water">Hand Water Only</option>
                            <option value="mixed">Mixed System</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="irr_run_times">Typical Run Times</label>
                        <input type="text" id="irr_run_times" placeholder="e.g. 8-12 min greens, 20 min fairways">
                    </div>
                </div>
                <div class="form-row single">
                    <div class="form-group">
                        <label for="irr_zones">Zones / Notes</label>
                        <input type="text" id="irr_zones" placeholder="e.g. 18 zones, central control, moisture sensors on greens">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Aerification Program</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="aer_dates">Typical Dates</label>
                        <input type="text" id="aer_dates" placeholder="e.g. April and September">
                    </div>
                    <div class="form-group">
                        <label for="aer_tine_type">Tine Type</label>
                        <select id="aer_tine_type">
                            <option value="">Select...</option>
                            <option value="hollow">Hollow Tine</option>
                            <option value="solid">Solid Tine</option>
                            <option value="needle">Needle Tine</option>
                            <option value="bayonet">Bayonet</option>
                            <option value="star">Star Tine</option>
                            <option value="mixed">Multiple Types</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="aer_depth">Depth</label>
                        <input type="text" id="aer_depth" placeholder='e.g. 3" on greens, 4" on fairways'>
                    </div>
                    <div class="form-group">
                        <label for="aer_areas">Areas</label>
                        <input type="text" id="aer_areas" placeholder="e.g. Greens, tees, fairways">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Topdressing Program</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="td_material">Material</label>
                        <input type="text" id="td_material" placeholder="e.g. USGA spec sand, 80/20 mix">
                    </div>
                    <div class="form-group">
                        <label for="td_rate">Rate</label>
                        <input type="text" id="td_rate" placeholder="e.g. Light dusting, 5 cu ft / 1000">
                    </div>
                </div>
                <div class="form-row single">
                    <div class="form-group">
                        <label for="td_frequency">Frequency</label>
                        <input type="text" id="td_frequency" placeholder="e.g. Every 2 weeks during growing season">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Bunker Sand</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="bunker_type">Sand Type</label>
                        <input type="text" id="bunker_type" placeholder="e.g. Best Sand, SP55, Tour Grade">
                    </div>
                    <div class="form-group">
                        <label for="bunker_depth">Depth</label>
                        <input type="text" id="bunker_depth" placeholder='e.g. 4" faces, 3" flat'>
                    </div>
                </div>
                <div class="form-row single">
                    <div class="form-group">
                        <label for="bunker_drainage">Drainage Notes</label>
                        <input type="text" id="bunker_drainage" placeholder="e.g. Better Billy Bunker liner, gravel base">
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== TAB 6: CALENDAR & PROGRAMS ===== -->
        <div class="tab-panel" id="tab-calendar">
            <div class="section">
                <h3>PGR Program</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="pgr_product">Product</label>
                        <input type="text" id="pgr_product" placeholder="e.g. Primo Maxx, T-Nex, Anuew">
                    </div>
                    <div class="form-group">
                        <label for="pgr_rate">Rate</label>
                        <input type="text" id="pgr_rate" placeholder="e.g. 0.125 oz/1000 on greens">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="pgr_interval">Application Interval</label>
                        <input type="text" id="pgr_interval" placeholder="e.g. Every 14 days, GDD-based at 200">
                    </div>
                    <div class="form-group">
                        <label for="pgr_areas">Areas</label>
                        <input type="text" id="pgr_areas" placeholder="e.g. Greens, tees, fairways">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Wetting Agent Program</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="wa_product">Product</label>
                        <input type="text" id="wa_product" placeholder="e.g. Revolution, Hydro-Wet, Dispatch">
                    </div>
                    <div class="form-group">
                        <label for="wa_rate">Rate</label>
                        <input type="text" id="wa_rate" placeholder="e.g. 6 oz/1000">
                    </div>
                </div>
                <div class="form-row single">
                    <div class="form-group">
                        <label for="wa_interval">Application Interval</label>
                        <input type="text" id="wa_interval" placeholder="e.g. Monthly May-Sep, every 30 days">
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Maintenance Calendar</h3>
                <span class="help-text" style="display:block;margin-bottom:12px;">Key tasks by month — helps AI provide timely recommendations</span>
                <div class="calendar-grid">
                    <div class="form-group"><label for="cal_jan">January</label><input type="text" id="cal_jan" placeholder="e.g. Equipment maintenance, planning"></div>
                    <div class="form-group"><label for="cal_feb">February</label><input type="text" id="cal_feb" placeholder="e.g. Soil testing, pre-emergent prep"></div>
                    <div class="form-group"><label for="cal_mar">March</label><input type="text" id="cal_mar" placeholder="e.g. Pre-emergent, spring cleanup"></div>
                    <div class="form-group"><label for="cal_apr">April</label><input type="text" id="cal_apr" placeholder="e.g. First mowing, fertilizer app"></div>
                    <div class="form-group"><label for="cal_may">May</label><input type="text" id="cal_may" placeholder="e.g. PGR starts, wetting agent"></div>
                    <div class="form-group"><label for="cal_jun">June</label><input type="text" id="cal_jun" placeholder="e.g. Summer stress prep, fungicide"></div>
                    <div class="form-group"><label for="cal_jul">July</label><input type="text" id="cal_jul" placeholder="e.g. Peak stress management"></div>
                    <div class="form-group"><label for="cal_aug">August</label><input type="text" id="cal_aug" placeholder="e.g. Aerification prep, overseed prep"></div>
                    <div class="form-group"><label for="cal_sep">September</label><input type="text" id="cal_sep" placeholder="e.g. Aerification, overseeding"></div>
                    <div class="form-group"><label for="cal_oct">October</label><input type="text" id="cal_oct" placeholder="e.g. Fall fert, winterizer"></div>
                    <div class="form-group"><label for="cal_nov">November</label><input type="text" id="cal_nov" placeholder="e.g. Late season cleanup"></div>
                    <div class="form-group"><label for="cal_dec">December</label><input type="text" id="cal_dec" placeholder="e.g. Snow mold prevention"></div>
                </div>
            </div>
        </div>

        <!-- ===== TAB 7: SOIL & WATER ===== -->
        <div class="tab-panel" id="tab-soil-water">
            <div class="section">
                <h3>Soil & Water</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="soil_type">Soil Type</label>
                        <select id="soil_type">
                            <option value="">Select soil...</option>
                            <option value="USGA sand-based">USGA Sand-Based</option>
                            <option value="native soil">Native Soil</option>
                            <option value="push-up">Push-Up</option>
                            <option value="sand-capped">Sand-Capped</option>
                            <option value="clay">Clay</option>
                            <option value="loam">Loam</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="irrigation_source">Irrigation Source</label>
                        <select id="irrigation_source">
                            <option value="">Select source...</option>
                            <option value="potable">Potable Water</option>
                            <option value="reclaimed">Reclaimed / Effluent</option>
                            <option value="well">Well Water</option>
                            <option value="pond">Pond / Lake</option>
                            <option value="river">River / Stream</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="soil_ph">Soil pH <span style="font-weight:400;color:#9ca3af;font-size:12px;">(from soil test)</span></label>
                        <input type="number" id="soil_ph" step="0.1" min="3" max="10" placeholder="e.g. 6.5">
                    </div>
                    <div class="form-group">
                        <label for="soil_om">Organic Matter % <span style="font-weight:400;color:#9ca3af;font-size:12px;">(from soil test)</span></label>
                        <input type="number" id="soil_om" step="0.1" min="0" max="100" placeholder="e.g. 2.5">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="water_ph">Water pH</label>
                        <input type="number" id="water_ph" step="0.1" min="3" max="10" placeholder="e.g. 7.2">
                    </div>
                    <div class="form-group">
                        <label for="water_ec">Water EC / Salinity <span style="font-weight:400;color:#9ca3af;font-size:12px;">(dS/m)</span></label>
                        <input type="number" id="water_ec" step="0.01" min="0" placeholder="e.g. 1.2">
                    </div>
                </div>
                <div class="form-row single">
                    <div class="form-group">
                        <label for="notes">Notes</label>
                        <textarea id="notes" placeholder="Anything else the AI should know — problem areas, budget constraints, environmental concerns, etc."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- Context preview card -->
        <div class="context-card" id="context-card">
            <h3 onclick="toggleContextPreview()">
                What the AI Sees <span style="font-weight:400;color:#6b7280;font-size:13px;">(your profile context)</span>
                <span class="chevron">&#9660;</span>
            </h3>
            <div class="context-body">
                <div id="ai-context-text" class="context-text">Save your profile to see the AI context.</div>
                <p style="font-size:11px;color:#9ca3af;margin-top:8px;">This text is injected into every AI conversation. Save to update.</p>
            </div>
        </div>

        <!-- Save bar -->
        <div class="save-bar">
            <button class="save-btn" id="save-btn" onclick="saveProfile()">Save Profile</button>
            <span class="save-toast" id="save-toast">&#10003; Profile saved</span>
            <a href="/" class="go-chat-btn" id="go-chat-btn">Go to Chat &rarr;</a>
        </div>
        <div class="skip-link" id="skip-link">
            <a href="/">Skip for now — go to chat &rarr;</a>
        </div>
    </div>

    <!-- Add Course Modal -->
    <div class="modal-overlay" id="add-course-modal" style="display:none;" onclick="if(event.target===this)closeAddCourseModal()">
        <div class="modal-content">
            <h3>Add Course</h3>
            <div class="form-group" style="margin-bottom:16px;">
                <label for="new-course-name">Course Name</label>
                <input type="text" id="new-course-name" placeholder="e.g. Back Nine Renovation">
            </div>
            <div class="form-group" style="margin-bottom:16px;">
                <label>Start from</label>
                <select id="new-course-source">
                    <option value="blank">Blank Profile</option>
                    <option value="duplicate">Duplicate Current Profile</option>
                    <option value="template">Template...</option>
                </select>
            </div>
            <div id="template-select-group" style="display:none;margin-bottom:16px;">
                <label>Template</label>
                <select id="template-select"></select>
            </div>
            <div style="display:flex;gap:8px;justify-content:flex-end;">
                <button onclick="closeAddCourseModal()" style="padding:8px 16px;background:#f3f4f6;border:none;border-radius:6px;cursor:pointer;">Cancel</button>
                <button onclick="addCourse()" style="padding:8px 20px;background:#1a4d2e;color:white;border:none;border-radius:6px;font-weight:600;cursor:pointer;">Create</button>
            </div>
        </div>
    </div>
    <script src="/static/js/profile.js"></script>
<script>
(function(){fetch('/api/me').then(function(r){return r.json()}).then(function(d){if(d.user&&d.user.is_admin){document.querySelectorAll('.nav-links,.mobile-nav-links').forEach(function(n){if(!n.querySelector('a[href="/admin"]')){var a=document.createElement('a');a.href='/admin';a.textContent='Admin';a.style.cssText='color:#fbbf24;font-weight:600';n.appendChild(a)}})}}).catch(function(){})})();
</script>
</body>
</html>
